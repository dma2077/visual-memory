Model path: /llm_reco/dehua/model/food_model/Qwen2.5-VL-food_pretrain/checkpoint-19099
Few-shot: None
Mode: nocot
Dataset: foodx251
K: 5
k1: 5
Using dataset: foodx251
Gold answer file path: /map-vepfs/dehua/code/visual-memory/answers/groundtruth/foodx251_answers.jsonl
Save filename: answers/foodx251/checkpoint-19099_foodx251_None_nocot_k5.jsonl
DINO file: questions/foodx251/dinov2_large_test_5_softmax_old.jsonl
SIGLIP file: questions/foodx251/siglip_test_5_softmax.jsonl
Data proportion: 1
INFO 06-09 23:35:51 [__init__.py:239] Automatically detected platform cuda.
Running with the following parameters:
model_path: /llm_reco/dehua/model/food_model/Qwen2.5-VL-food_pretrain/checkpoint-19099
save_filename: answers/foodx251/checkpoint-19099_foodx251_None_nocot_k5.jsonl
gold_answer_file_path: /map-vepfs/dehua/code/visual-memory/answers/groundtruth/foodx251_answers.jsonl
label_file: 
question_file: questions/foodx251/dinov2_large_test_5_softmax_old.jsonl
siglip_file: questions/foodx251/siglip_test_5_softmax.jsonl
data_proportion: 1.0
mode: nocot
k1: 5
tensor_parallel_size is 1
INFO 06-09 23:36:05 [config.py:717] This model supports multiple tasks: {'classify', 'embed', 'reward', 'score', 'generate'}. Defaulting to 'generate'.
INFO 06-09 23:36:05 [config.py:2003] Chunked prefill is enabled with max_num_batched_tokens=16384.
INFO 06-09 23:36:06 [core.py:58] Initializing a V1 LLM engine (v0.8.5.post1) with config: model='/llm_reco/dehua/model/food_model/Qwen2.5-VL-food_pretrain/checkpoint-19099', speculative_config=None, tokenizer='/llm_reco/dehua/model/food_model/Qwen2.5-VL-food_pretrain/checkpoint-19099', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=/llm_reco/dehua/model/food_model/Qwen2.5-VL-food_pretrain/checkpoint-19099, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-09 23:36:06 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fdf9322b790>
INFO 06-09 23:36:07 [parallel_state.py:1004] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-09 23:36:07 [cuda.py:221] Using Flash Attention backend on V1 engine.
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
WARNING 06-09 23:36:13 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
INFO 06-09 23:36:13 [gpu_model_runner.py:1329] Starting to load model /llm_reco/dehua/model/food_model/Qwen2.5-VL-food_pretrain/checkpoint-19099...
WARNING 06-09 23:36:13 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-09 23:36:13 [config.py:3614] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:20<01:00, 20.33s/it]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:36<00:35, 17.96s/it]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:41<00:11, 11.92s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:57<00:00, 13.50s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:57<00:00, 14.32s/it]

INFO 06-09 23:37:10 [loader.py:458] Loading weights took 57.53 seconds
INFO 06-09 23:37:11 [gpu_model_runner.py:1347] Model loading took 15.6271 GiB and 57.799954 seconds
INFO 06-09 23:37:14 [gpu_model_runner.py:1620] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-09 23:37:25 [backends.py:420] Using cache directory: /root/.cache/vllm/torch_compile_cache/b232b8beea/rank_0_0 for vLLM's torch.compile
INFO 06-09 23:37:25 [backends.py:430] Dynamo bytecode transform time: 5.96 s
INFO 06-09 23:37:27 [backends.py:136] Cache the graph of shape None for later use
INFO 06-09 23:37:49 [backends.py:148] Compiling a graph for general shape takes 23.31 s
INFO 06-09 23:38:00 [monitor.py:33] torch.compile takes 29.28 s in total
INFO 06-09 23:38:01 [kv_cache_utils.py:634] GPU KV cache size: 918,896 tokens
INFO 06-09 23:38:01 [kv_cache_utils.py:637] Maximum concurrency for 4,096 tokens per request: 224.34x
INFO 06-09 23:38:29 [gpu_model_runner.py:1686] Graph capturing finished in 28 secs, took 1.56 GiB
INFO 06-09 23:38:29 [core.py:159] init engine (profile, create kv cache, warmup model) took 78.21 seconds
INFO 06-09 23:38:32 [core_client.py:439] Core engine process 0 ready.
Loading test data:   0%|          | 0/11994 [00:00<?, ?it/s]Loading test data: 100%|██████████| 11994/11994 [00:00<00:00, 584619.20it/s]
Processing messages:   0%|          | 0/11994 [00:00<?, ?it/s]Processing messages:   0%|          | 44/11994 [00:00<00:27, 435.91it/s]Processing messages:   1%|          | 89/11994 [00:00<00:26, 442.63it/s]Processing messages:   1%|          | 134/11994 [00:00<00:27, 439.11it/s]Processing messages:   1%|▏         | 178/11994 [00:00<00:27, 435.46it/s]Processing messages:   2%|▏         | 222/11994 [00:00<00:27, 432.16it/s]Processing messages:   2%|▏         | 266/11994 [00:00<00:27, 432.79it/s]Processing messages:   3%|▎         | 310/11994 [00:00<00:27, 429.97it/s]Processing messages:   3%|▎         | 354/11994 [00:00<00:27, 426.91it/s]Processing messages:   3%|▎         | 397/11994 [00:00<00:27, 425.48it/s]Processing messages:   4%|▎         | 440/11994 [00:01<00:27, 423.73it/s]Processing messages:   4%|▍         | 484/11994 [00:01<00:26, 427.29it/s]Processing messages:   4%|▍         | 528/11994 [00:01<00:26, 429.23it/s]Processing messages:   5%|▍         | 571/11994 [00:01<00:27, 422.06it/s]Processing messages:   5%|▌         | 614/11994 [00:01<00:26, 423.54it/s]Processing messages:   5%|▌         | 657/11994 [00:01<00:27, 415.96it/s]Processing messages:   6%|▌         | 699/11994 [00:01<00:27, 413.49it/s]Processing messages:   6%|▌         | 743/11994 [00:01<00:26, 420.26it/s]Processing messages:   7%|▋         | 786/11994 [00:01<00:26, 422.51it/s]Processing messages:   7%|▋         | 829/11994 [00:01<00:26, 423.69it/s]Processing messages:   7%|▋         | 875/11994 [00:02<00:25, 433.81it/s]Processing messages:   8%|▊         | 920/11994 [00:02<00:25, 436.65it/s]Processing messages:   8%|▊         | 965/11994 [00:02<00:25, 438.36it/s]Processing messages:   8%|▊         | 1009/11994 [00:02<00:25, 437.08it/s]Processing messages:   9%|▉         | 1053/11994 [00:02<00:25, 433.10it/s]Processing messages:   9%|▉         | 1098/11994 [00:02<00:24, 435.93it/s]Processing messages:  10%|▉         | 1142/11994 [00:02<00:24, 436.10it/s]Processing messages:  10%|▉         | 1186/11994 [00:02<00:24, 435.59it/s]Processing messages:  10%|█         | 1232/11994 [00:02<00:24, 441.30it/s]Processing messages:  11%|█         | 1277/11994 [00:02<00:24, 442.75it/s]Processing messages:  11%|█         | 1322/11994 [00:03<00:24, 442.13it/s]Processing messages:  11%|█▏        | 1367/11994 [00:03<00:24, 434.67it/s]Processing messages:  12%|█▏        | 1411/11994 [00:03<00:24, 432.15it/s]Processing messages:  12%|█▏        | 1455/11994 [00:03<00:24, 431.46it/s]Processing messages:  12%|█▏        | 1499/11994 [00:03<00:24, 433.86it/s]Processing messages:  13%|█▎        | 1543/11994 [00:03<00:24, 431.34it/s]Processing messages:  13%|█▎        | 1587/11994 [00:03<00:24, 423.10it/s]Processing messages:  14%|█▎        | 1631/11994 [00:03<00:24, 426.55it/s]Processing messages:  14%|█▍        | 1678/11994 [00:03<00:23, 436.45it/s]Processing messages:  14%|█▍        | 1723/11994 [00:03<00:23, 438.47it/s]Processing messages:  15%|█▍        | 1768/11994 [00:04<00:23, 439.78it/s]Processing messages:  15%|█▌        | 1812/11994 [00:04<00:23, 438.14it/s]Processing messages:  15%|█▌        | 1856/11994 [00:04<00:23, 438.24it/s]Processing messages:  16%|█▌        | 1900/11994 [00:04<00:23, 424.49it/s]Processing messages:  16%|█▌        | 1943/11994 [00:04<00:23, 420.39it/s]Processing messages:  17%|█▋        | 1986/11994 [00:04<00:24, 416.20it/s]Processing messages:  17%|█▋        | 2028/11994 [00:04<00:24, 414.42it/s]Processing messages:  17%|█▋        | 2070/11994 [00:04<00:23, 415.18it/s]Processing messages:  18%|█▊        | 2112/11994 [00:04<00:23, 416.30it/s]Processing messages:  18%|█▊        | 2154/11994 [00:05<00:23, 416.05it/s]Processing messages:  18%|█▊        | 2197/11994 [00:05<00:23, 418.43it/s]Processing messages:  19%|█▊        | 2241/11994 [00:05<00:23, 423.74it/s]Processing messages:  19%|█▉        | 2284/11994 [00:05<00:23, 409.90it/s]Processing messages:  19%|█▉        | 2326/11994 [00:05<00:23, 411.00it/s]Processing messages:  20%|█▉        | 2369/11994 [00:05<00:23, 413.86it/s]Processing messages:  20%|██        | 2412/11994 [00:05<00:22, 417.33it/s]Processing messages:  20%|██        | 2454/11994 [00:05<00:23, 413.48it/s]Processing messages:  21%|██        | 2496/11994 [00:05<00:23, 411.76it/s]Processing messages:  21%|██        | 2538/11994 [00:05<00:22, 412.95it/s]Processing messages:  22%|██▏       | 2580/11994 [00:06<00:22, 412.27it/s]Processing messages:  22%|██▏       | 2624/11994 [00:06<00:22, 418.38it/s]Processing messages:  22%|██▏       | 2668/11994 [00:06<00:22, 422.60it/s]Processing messages:  23%|██▎       | 2712/11994 [00:06<00:21, 426.03it/s]Processing messages:  23%|██▎       | 2755/11994 [00:06<00:22, 416.08it/s]Processing messages:  23%|██▎       | 2800/11994 [00:06<00:21, 424.55it/s]Processing messages:  24%|██▎       | 2843/11994 [00:06<00:21, 423.04it/s]Processing messages:  24%|██▍       | 2888/11994 [00:06<00:21, 430.48it/s]Processing messages:  24%|██▍       | 2933/11994 [00:06<00:20, 433.46it/s]Processing messages:  25%|██▍       | 2978/11994 [00:06<00:20, 435.10it/s]Processing messages:  25%|██▌       | 3022/11994 [00:07<00:20, 435.26it/s]Processing messages:  26%|██▌       | 3066/11994 [00:07<00:20, 434.30it/s]Processing messages:  26%|██▌       | 3111/11994 [00:07<00:20, 438.27it/s]Processing messages:  26%|██▋       | 3155/11994 [00:07<00:20, 430.65it/s]Processing messages:  27%|██▋       | 3199/11994 [00:07<00:20, 427.99it/s]Processing messages:  27%|██▋       | 3242/11994 [00:07<00:20, 426.33it/s]Processing messages:  27%|██▋       | 3286/11994 [00:07<00:20, 430.26it/s]Processing messages:  28%|██▊       | 3330/11994 [00:07<00:20, 423.40it/s]Processing messages:  28%|██▊       | 3374/11994 [00:07<00:20, 425.75it/s]Processing messages:  28%|██▊       | 3417/11994 [00:08<00:20, 424.17it/s]Processing messages:  29%|██▉       | 3460/11994 [00:08<00:20, 423.89it/s]Processing messages:  29%|██▉       | 3503/11994 [00:08<00:20, 418.92it/s]Processing messages:  30%|██▉       | 3545/11994 [00:08<00:20, 418.87it/s]Processing messages:  30%|██▉       | 3591/11994 [00:08<00:19, 429.13it/s]Processing messages:  30%|███       | 3638/11994 [00:08<00:19, 437.49it/s]Processing messages:  31%|███       | 3683/11994 [00:08<00:18, 438.29it/s]Processing messages:  31%|███       | 3727/11994 [00:08<00:19, 431.78it/s]Processing messages:  31%|███▏      | 3771/11994 [00:08<00:18, 433.82it/s]Processing messages:  32%|███▏      | 3815/11994 [00:08<00:18, 435.54it/s]Processing messages:  32%|███▏      | 3860/11994 [00:09<00:18, 438.86it/s]Processing messages:  33%|███▎      | 3904/11994 [00:09<00:18, 434.55it/s]Processing messages:  33%|███▎      | 3948/11994 [00:09<00:18, 432.94it/s]Processing messages:  33%|███▎      | 3992/11994 [00:09<00:18, 424.46it/s]Processing messages:  34%|███▎      | 4035/11994 [00:09<00:18, 421.07it/s]Processing messages:  34%|███▍      | 4079/11994 [00:09<00:18, 426.52it/s]Processing messages:  34%|███▍      | 4122/11994 [00:09<00:18, 422.37it/s]Processing messages:  35%|███▍      | 4167/11994 [00:09<00:18, 427.49it/s]Processing messages:  35%|███▌      | 4210/11994 [00:09<00:18, 420.83it/s]Processing messages:  35%|███▌      | 4254/11994 [00:09<00:18, 425.40it/s]Processing messages:  36%|███▌      | 4297/11994 [00:10<00:18, 423.66it/s]Processing messages:  36%|███▌      | 4340/11994 [00:10<00:18, 418.05it/s]Processing messages:  37%|███▋      | 4384/11994 [00:10<00:17, 424.31it/s]Processing messages:  37%|███▋      | 4427/11994 [00:10<00:17, 424.22it/s]Processing messages:  37%|███▋      | 4472/11994 [00:10<00:17, 429.02it/s]Processing messages:  38%|███▊      | 4516/11994 [00:10<00:17, 430.14it/s]Processing messages:  38%|███▊      | 4560/11994 [00:10<00:17, 421.73it/s]Processing messages:  38%|███▊      | 4603/11994 [00:10<00:17, 420.04it/s]Processing messages:  39%|███▉      | 4648/11994 [00:10<00:17, 426.81it/s]Processing messages:  39%|███▉      | 4693/11994 [00:10<00:16, 430.79it/s]Processing messages:  40%|███▉      | 4738/11994 [00:11<00:16, 436.25it/s]Processing messages:  40%|███▉      | 4782/11994 [00:11<00:16, 436.69it/s]Processing messages:  40%|████      | 4826/11994 [00:11<00:16, 429.86it/s]Processing messages:  41%|████      | 4872/11994 [00:11<00:16, 435.59it/s]Processing messages:  41%|████      | 4916/11994 [00:11<00:16, 433.23it/s]Processing messages:  41%|████▏     | 4960/11994 [00:11<00:16, 425.14it/s]Processing messages:  42%|████▏     | 5003/11994 [00:11<00:16, 417.68it/s]Processing messages:  42%|████▏     | 5046/11994 [00:11<00:16, 421.01it/s]Processing messages:  42%|████▏     | 5089/11994 [00:11<00:16, 422.39it/s]Processing messages:  43%|████▎     | 5132/11994 [00:12<00:16, 422.58it/s]Processing messages:  43%|████▎     | 5176/11994 [00:12<00:15, 426.51it/s]Processing messages:  44%|████▎     | 5220/11994 [00:12<00:15, 428.71it/s]Processing messages:  44%|████▍     | 5263/11994 [00:12<00:15, 429.01it/s]Processing messages:  44%|████▍     | 5306/11994 [00:12<00:15, 426.31it/s]Processing messages:  45%|████▍     | 5349/11994 [00:12<00:15, 421.66it/s]Processing messages:  45%|████▍     | 5393/11994 [00:12<00:15, 425.91it/s]Processing messages:  45%|████▌     | 5436/11994 [00:12<00:15, 423.08it/s]Processing messages:  46%|████▌     | 5479/11994 [00:12<00:15, 419.67it/s]Processing messages:  46%|████▌     | 5522/11994 [00:12<00:15, 419.55it/s]Processing messages:  46%|████▋     | 5567/11994 [00:13<00:15, 426.39it/s]Processing messages:  47%|████▋     | 5610/11994 [00:13<00:15, 421.68it/s]Processing messages:  47%|████▋     | 5653/11994 [00:13<00:15, 422.06it/s]Processing messages:  47%|████▋     | 5696/11994 [00:13<00:14, 421.71it/s]Processing messages:  48%|████▊     | 5739/11994 [00:13<00:14, 422.99it/s]Processing messages:  48%|████▊     | 5784/11994 [00:13<00:14, 430.13it/s]Processing messages:  49%|████▊     | 5830/11994 [00:13<00:14, 437.40it/s]Processing messages:  49%|████▉     | 5874/11994 [00:13<00:13, 438.01it/s]Processing messages:  49%|████▉     | 5920/11994 [00:13<00:13, 442.29it/s]Processing messages:  50%|████▉     | 5965/11994 [00:13<00:13, 441.07it/s]Processing messages:  50%|█████     | 6010/11994 [00:14<00:13, 442.28it/s]Processing messages:  50%|█████     | 6055/11994 [00:14<00:13, 435.69it/s]Processing messages:  51%|█████     | 6099/11994 [00:14<00:13, 434.76it/s]Processing messages:  51%|█████     | 6144/11994 [00:14<00:13, 438.33it/s]Processing messages:  52%|█████▏    | 6188/11994 [00:14<00:13, 431.82it/s]Processing messages:  52%|█████▏    | 6232/11994 [00:14<00:13, 424.10it/s]Processing messages:  52%|█████▏    | 6275/11994 [00:14<00:13, 418.72it/s]Processing messages:  53%|█████▎    | 6319/11994 [00:14<00:13, 421.93it/s]Processing messages:  53%|█████▎    | 6362/11994 [00:14<00:13, 419.55it/s]Processing messages:  53%|█████▎    | 6404/11994 [00:14<00:13, 418.62it/s]Processing messages:  54%|█████▍    | 6448/11994 [00:15<00:13, 422.30it/s]Processing messages:  54%|█████▍    | 6491/11994 [00:15<00:13, 402.77it/s]Processing messages:  54%|█████▍    | 6532/11994 [00:15<00:13, 398.96it/s]Processing messages:  55%|█████▍    | 6576/11994 [00:15<00:13, 409.54it/s]Processing messages:  55%|█████▌    | 6619/11994 [00:15<00:12, 415.13it/s]Processing messages:  56%|█████▌    | 6661/11994 [00:15<00:12, 414.74it/s]Processing messages:  56%|█████▌    | 6708/11994 [00:15<00:12, 428.17it/s]Processing messages:  56%|█████▋    | 6752/11994 [00:15<00:12, 431.56it/s]Processing messages:  57%|█████▋    | 6796/11994 [00:15<00:12, 428.70it/s]Processing messages:  57%|█████▋    | 6843/11994 [00:16<00:11, 440.44it/s]Processing messages:  57%|█████▋    | 6888/11994 [00:16<00:11, 434.04it/s]Processing messages:  58%|█████▊    | 6932/11994 [00:16<00:11, 429.68it/s]Processing messages:  58%|█████▊    | 6976/11994 [00:16<00:11, 428.71it/s]Processing messages:  59%|█████▊    | 7019/11994 [00:16<00:11, 425.03it/s]Processing messages:  59%|█████▉    | 7062/11994 [00:16<00:11, 426.05it/s]Processing messages:  59%|█████▉    | 7108/11994 [00:16<00:11, 434.08it/s]Processing messages:  60%|█████▉    | 7153/11994 [00:16<00:11, 438.18it/s]Processing messages:  60%|██████    | 7197/11994 [00:16<00:11, 428.14it/s]Processing messages:  60%|██████    | 7240/11994 [00:16<00:11, 425.26it/s]Processing messages:  61%|██████    | 7284/11994 [00:17<00:11, 427.49it/s]Processing messages:  61%|██████    | 7328/11994 [00:17<00:10, 430.71it/s]Processing messages:  61%|██████▏   | 7372/11994 [00:17<00:10, 424.61it/s]Processing messages:  62%|██████▏   | 7417/11994 [00:17<00:10, 429.80it/s]Processing messages:  62%|██████▏   | 7462/11994 [00:17<00:10, 433.47it/s]Processing messages:  63%|██████▎   | 7506/11994 [00:17<00:10, 429.95it/s]Processing messages:  63%|██████▎   | 7550/11994 [00:17<00:10, 431.19it/s]Processing messages:  63%|██████▎   | 7594/11994 [00:17<00:10, 421.60it/s]Processing messages:  64%|██████▎   | 7641/11994 [00:17<00:10, 432.03it/s]Processing messages:  64%|██████▍   | 7685/11994 [00:17<00:09, 432.08it/s]Processing messages:  64%|██████▍   | 7729/11994 [00:18<00:09, 430.55it/s]Processing messages:  65%|██████▍   | 7773/11994 [00:18<00:09, 427.18it/s]Processing messages:  65%|██████▌   | 7816/11994 [00:18<00:09, 427.56it/s]Processing messages:  66%|██████▌   | 7860/11994 [00:18<00:09, 428.08it/s]Processing messages:  66%|██████▌   | 7903/11994 [00:18<00:09, 424.89it/s]Processing messages:  66%|██████▋   | 7947/11994 [00:18<00:09, 427.18it/s]Processing messages:  67%|██████▋   | 7991/11994 [00:18<00:09, 430.95it/s]Processing messages:  67%|██████▋   | 8036/11994 [00:18<00:09, 435.81it/s]Processing messages:  67%|██████▋   | 8083/11994 [00:18<00:08, 442.73it/s]Processing messages:  68%|██████▊   | 8128/11994 [00:19<00:08, 439.33it/s]Processing messages:  68%|██████▊   | 8172/11994 [00:19<00:08, 432.07it/s]Processing messages:  69%|██████▊   | 8216/11994 [00:19<00:08, 425.65it/s]Processing messages:  69%|██████▉   | 8259/11994 [00:19<00:08, 416.68it/s]Processing messages:  69%|██████▉   | 8301/11994 [00:19<00:09, 406.23it/s]Processing messages:  70%|██████▉   | 8346/11994 [00:19<00:08, 418.07it/s]Processing messages:  70%|██████▉   | 8392/11994 [00:19<00:08, 428.83it/s]Processing messages:  70%|███████   | 8435/11994 [00:19<00:08, 413.68it/s]Processing messages:  71%|███████   | 8478/11994 [00:19<00:08, 417.08it/s]Processing messages:  71%|███████   | 8521/11994 [00:19<00:08, 417.56it/s]Processing messages:  71%|███████▏  | 8565/11994 [00:20<00:08, 422.89it/s]Processing messages:  72%|███████▏  | 8609/11994 [00:20<00:07, 426.40it/s]Processing messages:  72%|███████▏  | 8654/11994 [00:20<00:07, 432.49it/s]Processing messages:  73%|███████▎  | 8698/11994 [00:20<00:07, 422.49it/s]Processing messages:  73%|███████▎  | 8742/11994 [00:20<00:07, 424.41it/s]Processing messages:  73%|███████▎  | 8785/11994 [00:20<00:07, 420.29it/s]Processing messages:  74%|███████▎  | 8832/11994 [00:20<00:07, 432.51it/s]Processing messages:  74%|███████▍  | 8877/11994 [00:20<00:07, 435.60it/s]Processing messages:  74%|███████▍  | 8921/11994 [00:20<00:07, 435.78it/s]Processing messages:  75%|███████▍  | 8965/11994 [00:20<00:06, 434.74it/s]Processing messages:  75%|███████▌  | 9009/11994 [00:21<00:06, 432.92it/s]Processing messages:  75%|███████▌  | 9053/11994 [00:21<00:06, 428.12it/s]Processing messages:  76%|███████▌  | 9096/11994 [00:21<00:06, 424.97it/s]Processing messages:  76%|███████▌  | 9139/11994 [00:21<00:06, 425.92it/s]Processing messages:  77%|███████▋  | 9184/11994 [00:21<00:06, 432.96it/s]Processing messages:  77%|███████▋  | 9228/11994 [00:21<00:06, 430.42it/s]Processing messages:  77%|███████▋  | 9272/11994 [00:21<00:06, 427.03it/s]Processing messages:  78%|███████▊  | 9315/11994 [00:21<00:06, 423.49it/s]Processing messages:  78%|███████▊  | 9359/11994 [00:21<00:06, 425.51it/s]Processing messages:  78%|███████▊  | 9404/11994 [00:22<00:06, 430.85it/s]Processing messages:  79%|███████▉  | 9448/11994 [00:22<00:05, 431.57it/s]Processing messages:  79%|███████▉  | 9492/11994 [00:22<00:05, 432.90it/s]Processing messages:  80%|███████▉  | 9537/11994 [00:22<00:05, 437.08it/s]Processing messages:  80%|███████▉  | 9581/11994 [00:22<00:05, 429.98it/s]Processing messages:  80%|████████  | 9627/11994 [00:22<00:05, 438.75it/s]Processing messages:  81%|████████  | 9672/11994 [00:22<00:05, 441.00it/s]Processing messages:  81%|████████  | 9719/11994 [00:22<00:05, 446.80it/s]Processing messages:  81%|████████▏ | 9765/11994 [00:22<00:04, 449.62it/s]Processing messages:  82%|████████▏ | 9810/11994 [00:22<00:04, 448.13it/s]Processing messages:  82%|████████▏ | 9855/11994 [00:23<00:04, 445.28it/s]Processing messages:  83%|████████▎ | 9900/11994 [00:23<00:04, 444.79it/s]Processing messages:  83%|████████▎ | 9945/11994 [00:23<00:04, 443.64it/s]Processing messages:  83%|████████▎ | 9990/11994 [00:23<00:04, 434.61it/s]Processing messages:  84%|████████▎ | 10034/11994 [00:23<00:04, 433.28it/s]Processing messages:  84%|████████▍ | 10079/11994 [00:23<00:04, 436.51it/s]Processing messages:  84%|████████▍ | 10123/11994 [00:23<00:04, 423.52it/s]Processing messages:  85%|████████▍ | 10168/11994 [00:23<00:04, 429.06it/s]Processing messages:  85%|████████▌ | 10211/11994 [00:23<00:04, 424.17it/s]Processing messages:  86%|████████▌ | 10256/11994 [00:23<00:04, 430.43it/s]Processing messages:  86%|████████▌ | 10301/11994 [00:24<00:03, 436.01it/s]Processing messages:  86%|████████▋ | 10345/11994 [00:24<00:03, 436.08it/s]Processing messages:  87%|████████▋ | 10389/11994 [00:24<00:03, 423.18it/s]Processing messages:  87%|████████▋ | 10432/11994 [00:24<00:03, 421.77it/s]Processing messages:  87%|████████▋ | 10475/11994 [00:24<00:03, 422.09it/s]Processing messages:  88%|████████▊ | 10518/11994 [00:24<00:03, 419.99it/s]Processing messages:  88%|████████▊ | 10561/11994 [00:24<00:03, 422.08it/s]Processing messages:  88%|████████▊ | 10606/11994 [00:24<00:03, 430.03it/s]Processing messages:  89%|████████▉ | 10651/11994 [00:24<00:03, 435.62it/s]Processing messages:  89%|████████▉ | 10695/11994 [00:24<00:02, 433.72it/s]Processing messages:  90%|████████▉ | 10739/11994 [00:25<00:02, 433.17it/s]Processing messages:  90%|████████▉ | 10783/11994 [00:25<00:02, 420.79it/s]Processing messages:  90%|█████████ | 10826/11994 [00:25<00:02, 422.38it/s]Processing messages:  91%|█████████ | 10869/11994 [00:25<00:02, 419.61it/s]Processing messages:  91%|█████████ | 10912/11994 [00:25<00:02, 419.63it/s]Processing messages:  91%|█████████▏| 10955/11994 [00:25<00:02, 422.35it/s]Processing messages:  92%|█████████▏| 11001/11994 [00:25<00:02, 430.96it/s]Processing messages:  92%|█████████▏| 11045/11994 [00:25<00:02, 429.62it/s]Processing messages:  92%|█████████▏| 11089/11994 [00:25<00:02, 430.31it/s]Processing messages:  93%|█████████▎| 11135/11994 [00:26<00:01, 438.62it/s]Processing messages:  93%|█████████▎| 11181/11994 [00:26<00:01, 443.23it/s]Processing messages:  94%|█████████▎| 11226/11994 [00:26<00:01, 444.19it/s]Processing messages:  94%|█████████▍| 11271/11994 [00:26<00:01, 440.98it/s]Processing messages:  94%|█████████▍| 11316/11994 [00:26<00:01, 438.12it/s]Processing messages:  95%|█████████▍| 11360/11994 [00:26<00:01, 437.31it/s]Processing messages:  95%|█████████▌| 11405/11994 [00:26<00:01, 440.33it/s]Processing messages:  95%|█████████▌| 11450/11994 [00:26<00:01, 437.31it/s]Processing messages:  96%|█████████▌| 11494/11994 [00:26<00:01, 436.90it/s]Processing messages:  96%|█████████▌| 11538/11994 [00:26<00:01, 429.22it/s]Processing messages:  97%|█████████▋| 11582/11994 [00:27<00:00, 431.59it/s]Processing messages:  97%|█████████▋| 11626/11994 [00:27<00:00, 433.44it/s]Processing messages:  97%|█████████▋| 11672/11994 [00:27<00:00, 439.87it/s]Processing messages:  98%|█████████▊| 11717/11994 [00:27<00:00, 433.78it/s]Processing messages:  98%|█████████▊| 11761/11994 [00:27<00:00, 432.23it/s]Processing messages:  98%|█████████▊| 11805/11994 [00:27<00:00, 433.39it/s]Processing messages:  99%|█████████▉| 11850/11994 [00:27<00:00, 437.64it/s]Processing messages:  99%|█████████▉| 11894/11994 [00:27<00:00, 427.04it/s]Processing messages: 100%|█████████▉| 11937/11994 [00:27<00:00, 420.09it/s]Processing messages: 100%|█████████▉| 11980/11994 [00:27<00:00, 418.72it/s]Processing messages: 100%|██████████| 11994/11994 [00:28<00:00, 428.23it/s]
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Processed prompts:   0%|          | 0/11994 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  22%|██▏       | 2594/11994 [00:00<00:00, 25895.76it/s, est. speed input: 3861438.26 toks/s, output: 116863.96 toks/s]Processed prompts:  42%|████▏     | 5077/11994 [00:18<00:00, 25895.76it/s, est. speed input: 45405.58 toks/s, output: 1352.61 toks/s]    Processed prompts:  42%|████▏     | 5078/11994 [00:18<00:29, 231.54it/s, est. speed input: 40705.10 toks/s, output: 1212.79 toks/s]  Processed prompts:  43%|████▎     | 5175/11994 [00:20<00:32, 208.40it/s, est. speed input: 37601.99 toks/s, output: 1119.22 toks/s]Processed prompts:  52%|█████▏    | 6185/11994 [00:38<00:27, 208.40it/s, est. speed input: 25233.30 toks/s, output: 735.14 toks/s] Processed prompts:  52%|█████▏    | 6186/11994 [00:38<00:51, 112.49it/s, est. speed input: 23985.53 toks/s, output: 698.89 toks/s]Processed prompts:  52%|█████▏    | 6258/11994 [00:40<00:54, 105.95it/s, est. speed input: 23136.64 toks/s, output: 672.17 toks/s]Processed prompts:  57%|█████▋    | 6841/11994 [00:49<00:58, 88.46it/s, est. speed input: 20446.97 toks/s, output: 590.22 toks/s] Processed prompts:  60%|██████    | 7197/11994 [00:55<00:58, 81.73it/s, est. speed input: 19277.98 toks/s, output: 552.55 toks/s]Processed prompts:  62%|██████▏   | 7427/11994 [00:59<00:59, 76.99it/s, est. speed input: 18557.85 toks/s, output: 530.01 toks/s]Processed prompts:  63%|██████▎   | 7581/11994 [01:03<01:05, 67.70it/s, est. speed input: 17704.58 toks/s, output: 504.63 toks/s]Processed prompts:  64%|██████▍   | 7686/11994 [01:05<01:05, 65.46it/s, est. speed input: 17396.03 toks/s, output: 496.53 toks/s]Processed prompts:  65%|██████▍   | 7759/11994 [01:07<01:09, 60.96it/s, est. speed input: 17052.87 toks/s, output: 487.60 toks/s]Processed prompts:  65%|██████▌   | 7834/11994 [01:09<01:13, 56.61it/s, est. speed input: 16728.88 toks/s, output: 477.91 toks/s]Processed prompts:  66%|██████▋   | 7948/11994 [01:11<01:10, 57.16it/s, est. speed input: 16519.35 toks/s, output: 470.92 toks/s]Processed prompts:  67%|██████▋   | 8084/11994 [01:13<01:05, 59.93it/s, est. speed input: 16349.58 toks/s, output: 467.12 toks/s]Processed prompts:  68%|██████▊   | 8213/11994 [01:15<01:01, 61.62it/s, est. speed input: 16189.93 toks/s, output: 461.63 toks/s]Processed prompts:  70%|██████▉   | 8339/11994 [01:17<00:58, 62.51it/s, est. speed input: 16029.39 toks/s, output: 455.69 toks/s]Processed prompts:  70%|██████▉   | 8378/11994 [01:19<01:11, 50.69it/s, est. speed input: 15707.70 toks/s, output: 446.34 toks/s]Processed prompts:  70%|███████   | 8431/11994 [01:21<01:22, 43.01it/s, est. speed input: 15397.03 toks/s, output: 437.71 toks/s]Processed prompts:  71%|███████▏  | 8564/11994 [01:23<01:08, 49.93it/s, est. speed input: 15275.20 toks/s, output: 434.90 toks/s]Processed prompts:  72%|███████▏  | 8681/11994 [01:25<01:02, 52.96it/s, est. speed input: 15133.68 toks/s, output: 431.21 toks/s]Processed prompts:  73%|███████▎  | 8777/11994 [01:27<01:01, 52.14it/s, est. speed input: 14969.54 toks/s, output: 426.52 toks/s]Processed prompts:  74%|███████▍  | 8882/11994 [01:29<01:00, 51.32it/s, est. speed input: 14789.84 toks/s, output: 421.69 toks/s]Processed prompts:  75%|███████▌  | 9030/11994 [01:31<00:51, 58.05it/s, est. speed input: 14710.71 toks/s, output: 419.64 toks/s]Processed prompts:  76%|███████▋  | 9146/11994 [01:33<00:49, 57.41it/s, est. speed input: 14571.06 toks/s, output: 415.42 toks/s]Processed prompts:  77%|███████▋  | 9286/11994 [01:35<00:43, 61.85it/s, est. speed input: 14499.94 toks/s, output: 412.49 toks/s]Processed prompts:  78%|███████▊  | 9317/11994 [01:37<00:55, 48.35it/s, est. speed input: 14257.23 toks/s, output: 405.67 toks/s]Processed prompts:  79%|███████▉  | 9495/11994 [01:39<00:41, 60.94it/s, est. speed input: 14239.92 toks/s, output: 404.97 toks/s]Processed prompts:  80%|███████▉  | 9587/11994 [01:41<00:42, 56.89it/s, est. speed input: 14097.05 toks/s, output: 400.48 toks/s]Processed prompts:  81%|████████  | 9714/11994 [01:43<00:38, 59.55it/s, est. speed input: 14015.66 toks/s, output: 397.98 toks/s]Processed prompts:  82%|████████▏ | 9797/11994 [01:45<00:40, 54.66it/s, est. speed input: 13874.91 toks/s, output: 393.88 toks/s]Processed prompts:  82%|████████▏ | 9876/11994 [01:47<00:41, 50.43it/s, est. speed input: 13732.84 toks/s, output: 389.56 toks/s]Processed prompts:  83%|████████▎ | 9986/11994 [01:49<00:38, 52.48it/s, est. speed input: 13646.25 toks/s, output: 386.57 toks/s]Processed prompts:  84%|████████▍ | 10131/11994 [01:51<00:31, 59.32it/s, est. speed input: 13602.64 toks/s, output: 385.83 toks/s]Processed prompts:  85%|████████▌ | 10220/11994 [01:53<00:31, 55.50it/s, est. speed input: 13488.84 toks/s, output: 382.62 toks/s]Processed prompts:  87%|████████▋ | 10376/11994 [01:55<00:25, 63.11it/s, est. speed input: 13467.39 toks/s, output: 381.25 toks/s]Processed prompts:  88%|████████▊ | 10521/11994 [01:56<00:22, 66.82it/s, est. speed input: 13433.90 toks/s, output: 379.26 toks/s]Processed prompts:  88%|████████▊ | 10565/11994 [01:58<00:26, 53.65it/s, est. speed input: 13270.21 toks/s, output: 374.34 toks/s]Processed prompts:  89%|████████▉ | 10672/11994 [02:00<00:24, 54.12it/s, est. speed input: 13186.86 toks/s, output: 371.59 toks/s]Processed prompts:  90%|████████▉ | 10759/11994 [02:02<00:23, 51.56it/s, est. speed input: 13087.58 toks/s, output: 369.03 toks/s]Processed prompts:  90%|█████████ | 10837/11994 [02:04<00:23, 48.23it/s, est. speed input: 12975.55 toks/s, output: 365.63 toks/s]Processed prompts:  92%|█████████▏| 10979/11994 [02:06<00:18, 56.01it/s, est. speed input: 12950.52 toks/s, output: 365.10 toks/s]Processed prompts:  92%|█████████▏| 11042/11994 [02:08<00:19, 49.15it/s, est. speed input: 12830.24 toks/s, output: 361.66 toks/s]Processed prompts:  93%|█████████▎| 11110/11994 [02:10<00:19, 44.99it/s, est. speed input: 12719.46 toks/s, output: 358.83 toks/s]Processed prompts:  94%|█████████▍| 11330/11994 [02:12<00:10, 65.91it/s, est. speed input: 12779.80 toks/s, output: 360.66 toks/s]Processed prompts:  95%|█████████▌| 11404/11994 [02:14<00:10, 57.78it/s, est. speed input: 12679.41 toks/s, output: 357.92 toks/s]Processed prompts:  96%|█████████▌| 11488/11994 [02:16<00:09, 53.45it/s, est. speed input: 12592.15 toks/s, output: 355.18 toks/s]Processed prompts:  97%|█████████▋| 11631/11994 [02:16<00:05, 71.79it/s, est. speed input: 12668.32 toks/s, output: 357.66 toks/s]Processed prompts: 100%|█████████▉| 11993/11994 [02:17<00:00, 164.29it/s, est. speed input: 13059.20 toks/s, output: 368.50 toks/s]Processed prompts: 100%|██████████| 11994/11994 [02:17<00:00, 87.48it/s, est. speed input: 13060.11 toks/s, output: 368.53 toks/s] 
VLM inference for foodx251 completed. Results saved to answers/foodx251/checkpoint-19099_foodx251_None_nocot_k5.jsonl
